version: "3.9"

x-bot-template: &bot-template
  restart: unless-stopped
  working_dir: /app
  command: ["python3", "-u", "bot.py"]
  environment:
    TZ: Europe/Malta
    PYTHONUNBUFFERED: "1"
  logging:
    driver: json-file
    options:
      max-size: "10m"
      max-file: "3"

services:
  autocontenuelisabot:
    <<: *bot-template
    build: 
      context: ./autocontenuelisabot
      dockerfile: Dockerfile
    container_name: autocontenuelisabot
    volumes:
      # Mount the entire app directory (read-only for code)
      - ./autocontenuelisabot:/app:ro
      # Mount database and session directories with write permissions
      - autocontenuelisabot_database:/app/database
      - autocontenuelisabot_session:/app/session
    networks:
      - contentlisa_network

# Named volumes for data persistence
volumes:
  autocontenuelisabot_database:
    driver: local
  autocontenuelisabot_session:
    driver: local

# Network for service isolation
networks:
  contentlisa_network:
    driver: bridge
